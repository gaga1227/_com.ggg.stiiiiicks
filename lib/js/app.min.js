window.App=function(t){var i=t||{};return i.data={game:{status:"",totalMoves:0,totalCheats:0,totalAlignments:0,stiiiiicks:5,scrambleMoves:1},levels:{currentLevel:null,defaultLevel:1,0:{id:0,sticksCount:2,moveDeterRatio:.5,initialStiiiiicks:3},1:{id:1,sticksCount:3,moveDeterRatio:.5,initialStiiiiicks:5},2:{id:2,sticksCount:4,moveDeterRatio:.5,initialStiiiiicks:15},3:{id:3,sticksCount:5,moveDeterRatio:.5,initialStiiiiicks:25}},msg:{connection_error:["Data Request Failed","Please make sure your device has a working connection and try again."],content_unavailable:["Content Unavailable","The content you requested is not available in this version of the app, please contact support."],offline:["No Connection Found","This app requires a working internet connection to work properly."]},init:function(){}},i}(window.App),window.App=function(t){var i=t||{};return function(){var t,i=0,e=["webkit"];for(t=0;t<e.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[e[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[t]+"CancelAnimationFrame"]||window[e[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var e=(new Date).getTime(),s=Math.max(0,16-(e-i)),a=window.setTimeout(function(){t(e+s)},s);return i=e+s,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){window.clearTimeout(t)})}(),window.Platform=function(){function t(t){return e.indexOf(t.toLowerCase())>-1}function i(t){return t in document.documentElement}var e=navigator.userAgent.toLowerCase();return this.iPhone=t("iPhone"),this.iPad=t("iPad"),this.iPod=t("iPod"),this.iOS=this.iPhone||this.iPad||this.iPod,this.android=t("android"),this.touchOS=i("ontouchstart"),this.chrome=e.indexOf("chrome")>-1,this.debugLog=function(){console.log("iPhone: "+this.iPhone),console.log("iPad: "+this.iPad),console.log("iPod: "+this.iPod),console.log("iOS: "+this.iOS),console.log("android: "+this.android),console.log("touchOS: "+this.touchOS)},this}(),window.applicationCache&&window.applicationCache.addEventListener("updateready",function(){confirm("An update is available. Reload now?")&&window.location.reload()}),i.utils={addDeviceClass:function(){var t=Platform;$html=$("html:eq(0)"),$html.removeClass("no-js").addClass("js"),$html.addClass(t.touchOS?"touch":"no-touch"),t.iOS?($html.addClass("ios"),t.iPhone?$html.addClass("iphone"):t.iPod?$html.addClass("ipod"):t.iPad&&$html.addClass("ipad")):t.android&&$html.addClass("android")},noTouchBounce:function(t){var i=$(t?t:"body");i.off("touchmove.noTouchBounce").on("touchmove.noTouchBounce",function(t){t.preventDefault()})},loadTemplates:function(){var t=$('script[id|="template"]');if(t.length){var i={};return _.forEach(t,function(t){var e=$(t),s=e.attr("id").split("-")[1];tmplHtml=$.trim(e.html()),tmplHtml&&(i[s]=tmplHtml)}),i}},popMsg:function(t){if(!_.isPlainObject(t)||_.isUndefined(t.text))return"invalid message text!";if($("#message").length)return i.view.activeMsg?(i.view.messages.push(t),"[popMsg]: message modal active, putting into messages queue..."):"previous message not finished!";t.duration=_.isUndefined(t.duration)?1:t.duration;var e=$(i.view.templates.message),s=e.find(".overlay"),a=e.find(".modal"),n={scale:0,rotationX:90},o={css:{scale:1,rotationX:0},onComplete:_.bind(function(){0===t.duration?a.one("click",function(){TweenLite.to(s[0],i.view.animSpeed.msg/2,r),i.view.activeMsg=TweenLite.to(a[0],i.view.animSpeed.msg/2,c)}):(TweenLite.to(s[0],i.view.animSpeed.msg/2,r),i.view.activeMsg=TweenLite.to(a[0],i.view.animSpeed.msg/2,c))},this)},c={css:{scale:0,rotationX:-90},delay:t.duration,onComplete:_.bind(function(){"function"==typeof t.onComplete&&_.bind(t.onComplete,this)(),e.remove(),i.view.activeMsg=null,i.view.messages.length&&this.popMsg(i.view.messages.shift())},this)},h={opacity:0},l={opacity:1},r={opacity:0,delay:t.duration};e.find(".msgText").html(t.text),e.appendTo("body"),TweenLite.set(s[0],h),TweenLite.to(s[0],i.view.animSpeed.msg,l),TweenLite.set(a[0],n),i.view.activeMsg=TweenLite.to(a[0],i.view.animSpeed.msg,o)},init:function(){this.addDeviceClass()}},i}(window.App),window.App=function(t){var i=t||{};return i.view={events:{transitionEnd:"transitionend webkitTransitionEnd"},areAllSticksAligned:!1,canvasData:null,sticksData:[],sticksHintData:[],hintData:{},touchData:{holdDelay:500,touchMoveDelay:60},activeMsg:null,messages:[],animSpeed:{norm:.25,msg:.5,scoreUp:.1,scoreDown:.8},gui:{$scoreText:$("#game .gui.top .title .text"),$scoreLabel:$("#game .gui.top .title .label"),levelClasses:["level0","level1","level2","level3"]},$game:$("#game"),$gameBg:$("#gameBg"),$gameCanvas:$("#gameCanvas"),$sticksLayer:$("#sticksLayer"),$sticksHintLayer:$("#sticksHintLayer"),$bgAnimLayer:$("#bgAnimLayer"),$gridLayer:$("#gridLayer"),$settings:$("#settings"),$dialogue:$("#dialogue"),animateStickActive:function(t){TweenLite.to(t,this.animSpeed.norm,{opacity:"1"})},animateStickInactive:function(t){TweenLite.to(t,this.animSpeed.norm,{opacity:"0.5"})},animateStickNorm:function(t){TweenLite.to(t,this.animSpeed.norm,{opacity:"1"})},touchEvents:["touchstart.gameCanvas","touchmove.gameCanvas","touchend.gameCanvas","touchleave.gameCanvas","touchcancel.gameCanvas"],onTouchStart:function(t){this.updateMoveHintOnTouch(t),this.updateStickHintOnTouch(t),this.updatePositionHintOnTouch(t)},onTouchMove:function(t){this.updateMoveHintOnTouch(t),this.updateStickHintOnTouch(t),this.updatePositionHintOnTouch(t)},onTouchEnd:function(t){this.updateMoveHintOnTouch(t),this.updateStickHintOnTouch(t),this.updatePositionHintOnTouch(t)},updateMoveHintOnTouch:function(t){var e,s,a=i.data.levels[i.data.levels.currentLevel],n=1/a.moveDeterRatio,o=Math.floor(this.canvasData.width/2);if(t.originalEvent.touches[0]&&(e=t.originalEvent.touches[0].clientX-this.canvasData.offset.left),"touchstart"===t.type)this.hintData.moveHintTimeout=setTimeout(_.bind(function(){return this.hintData.stickHintIsActive||this.hintData.positionHintIsActive?!1:(this.hintData.moveHintIsActive=1,void(this.hintData.touchMoveAnchorX=e))},this),this.touchData.touchMoveDelay);else if("touchmove"===t.type){if(this.hintData.stickHintIsActive||this.hintData.positionHintIsActive)return!1;if(clearTimeout(this.hintData.moveHintTimeout),this.hintData.moveHintTimeout=null,this.hintData.moveHintIsActive){this.hintData.moveHintIsActive=2;var c=e-this.hintData.touchMoveAnchorX,h=Math.abs(c),l=Math.round(this.sticksData[0].$el.width()/2);s=this.hintData.primaryStickIndex=this.getTargetStickIndex(t),o>=h&&_.forEach(this.sticksData,_.bind(function(t){var i=Math.abs(t.id-s)+1,e=c/Math.pow(n,i),a=this.canvasData.movePositions[t.newpos],o=a+e;o>this.canvasData.width?(o=this.canvasData.width-(o-this.canvasData.width),e=o-a):0>o&&(o=0-o,e=o-a),t.newpos===this.canvasData.movePositions.length-1?e+=l:0===t.newpos&&(e-=l);var h={x:Math.round(e)};TweenLite.to(t.$el[0],0,h),1===i?this.animateStickActive(t.$el[0]):this.animateStickInactive(t.$el[0])},this))}}else if(clearTimeout(this.hintData.moveHintTimeout),this.hintData.moveHintTimeout=null,this.hintData.moveHintIsActive){this.hintData.moveHintIsActive=!1;var r={opacity:"1",x:0,onComplete:_.bind(function(){this.hintData.touchMoveAnchorX=null},this)};_.forEach(this.sticksData,_.bind(function(t){TweenLite.to(t.$el[0],this.animSpeed.norm,r)},this))}},updateStickHintOnTouch:function(t){if("touchstart"===t.type)this.hintData.stickHintTimeout=setTimeout(_.bind(function(){return 2===this.hintData.moveHintIsActive?!1:(this.hintData.stickHintIsActive=!0,this.$activeStick=this.sticksData[this.getTargetStickIndex(t,!0)].$el,this.animateStickActive(this.$activeStick[0]),void this.$activeStick.siblings(".stick").each(_.bind(function(t,i){this.animateStickInactive(i)},this)))},this),this.touchData.holdDelay);else if("touchmove"===t.type){if(clearTimeout(this.hintData.stickHintTimeout),this.hintData.stickHintTimeout=null,this.hintData.stickHintIsActive){var i=this.$activeStick,e=this.sticksData[this.getTargetStickIndex(t,!0)].$el;if(!i||!e)return!1;i.index()!==e.index()&&(this.$activeStick=e),this.animateStickActive(this.$activeStick[0]),this.$activeStick.siblings(".stick").each(_.bind(function(t,i){this.animateStickInactive(i)},this))}}else clearTimeout(this.hintData.stickHintTimeout),this.hintData.stickHintTimeout=null,this.hintData.stickHintIsActive&&(this.hintData.stickHintIsActive=!1,this.$sticksLayer.find(".stick").each(_.bind(function(t,i){this.animateStickNorm(i)},this)))},updatePositionHintOnTouch:function(t){var i,e,s=[];"touchstart"===t.type?this.hintData.positionHintTimeout=setTimeout(_.bind(function(){return 2===this.hintData.moveHintIsActive?!1:(_.forEach(this.sticksData,_.bind(function(t){var i={},e=$("#"+t.$el.attr("id")+"-hint");e.length?(i.$el=e,i.$el.css({left:t.$el.css("left"),marginLeft:t.$el.css("marginLeft")})):(i.$el=t.$el.clone(),i.$el.addClass("hint").removeClass("active").attr("id",i.$el.attr("id")+"-hint").appendTo(this.$sticksHintLayer)),i.id=t.id,i.pos=t.pos,this.sticksHintData[t.id-1]=i},this)),i=this.hintData.primaryStickIndex=this.getTargetStickIndex(t),e=this.hintData.swipeDirection=this.getSwipeDirection(t),s=_.cloneDeep(this.sticksHintData),this.calculateStickPositions(s,i,e),this.hintData.positionHintIsActive=!0,this.$sticksHintLayer.show(),this.$sticksLayer.addClass("blur"),void this.renderSticks(s,this.$sticksHintLayer,!0))},this),this.touchData.holdDelay):"touchmove"===t.type?(clearTimeout(this.hintData.positionHintTimeout),this.hintData.positionHintTimeout=null,this.hintData.positionHintIsActive&&(i=this.getTargetStickIndex(t),e=this.getSwipeDirection(t),(i!==this.hintData.primaryStickIndex||e!==this.hintData.swipeDirection)&&(this.hintData.primaryStickIndex=i,this.hintData.swipeDirection=e,s=_.cloneDeep(this.sticksHintData),this.calculateStickPositions(s,i,e),this.renderSticks(s,this.$sticksHintLayer,!0)))):(clearTimeout(this.hintData.positionHintTimeout),this.hintData.positionHintTimeout=null,this.hintData.positionHintIsActive&&(_.forEach(this.sticksHintData,_.bind(function(t){var i={left:this.sticksData[t.id-1].$el.css("left"),marginLeft:this.sticksData[t.id-1].$el.css("marginLeft"),opacity:"0"};t.id==this.sticksHintData.length&&(i=_.merge(i,{onComplete:_.bind(function(){this.$sticksHintLayer.hide(),this.$sticksLayer.removeClass("blur"),this.hintData.positionHintIsActive=!1},this)})),TweenLite.to(t.$el[0],this.animSpeed.norm,i)},this)),this.hintData.primaryStickIndex=null,this.hintData.swipeDirection=null,this.sticksHintData=[]))},initTouch:function(){this.$gameCanvas.off(this.touchEvents.join(" ")).on(this.touchEvents[0],_.bind(this.onTouchStart,this)).on(this.touchEvents[1],_.bind(this.onTouchMove,this)).on(this.touchEvents[2],_.bind(this.onTouchEnd,this)).on(this.touchEvents[3],_.bind(this.onTouchEnd,this)).on(this.touchEvents[4],_.bind(this.onTouchEnd,this))},initHammer:function(){this.hammer&&(this.hammer.off("tap swipe"),this.hammer.destroy(),this.hammer=null),this.hammer=new Hammer(this.$gameCanvas[0]),this.hammer.on("tap swipe",_.bind(function(t){if(this.gameInputDisabled)return"[view.initHammer]: game input ignored";i.data.game.totalMoves++,i.data.game.stiiiiicks-=1,this.$game.trigger({type:"update.score",amount:-1});var e,s=t.center.x-this.canvasData.offset.left,a=t.center.y-this.canvasData.offset.top,n=this.canvasData.height/this.sticksData.length,o=Math.ceil(a/n);"tap"==t.type?e=s<this.canvasData.width/2?"left":"right":"swipe"==t.type&&(2==t.direction?e="left":4==t.direction&&(e="right")),this.calculateStickPositions(!1,o,e),this.renderSticks(!1,!1,!0)},this))},getCanvasData:function(){var t={width:this.$gameCanvas.width(),height:this.$gameCanvas.height(),offset:this.$gameCanvas.offset()};return t},getMaxMoveSegments:function(t){var i=Math.pow(1/t.moveDeterRatio,t.sticksCount);this.canvasData.movePositions=[];for(var e=0;i>=e;e++)this.canvasData.movePositions.push(Math.round(e*this.canvasData.width/i));return i},getTargetStickIndex:function(t,i){var e=t.originalEvent.touches[0].clientY-this.canvasData.offset.top,s=this.sticksData.length,a=this.canvasData.height/s,n=Math.floor(e/a)+(i?0:1);return n>=0?n:!1},getSwipeDirection:function(t){var i,e=t.originalEvent.touches[0].clientX-this.canvasData.offset.left;return i=e<this.canvasData.width/2?"left":"right"},getReverseSwipeDirection:function(t,i){var e,s=t>i,a=Math.abs(this.maxMoveSegments-t)>i;return e=t%i===0?0===t?"left":t==this.maxMoveSegments?"right":Math.random()<.5?"left":"right":s&&a?Math.random()<.5?"left":"right":s&&!a?"left":"right"},addSticks:function(t){if(_.isUndefined(t)||_.isNaN(t))return console.log("[view.addSticks]: invalid sticks count supplied!"),!1;this.sticksData.length&&(this.sticksData=[]);for(var i=this.getCanvasData(),e=this.$sticksLayer.find(".stick");t--;){var s=this.sticksData.length+1,a=s<=e.length,n=$(a?e[s-1]:"<div/>");n.addClass("stick").attr("id","stick-"+s).css({width:"0px",height:"0px",top:Math.round(i.height/2)+"px",left:Math.round(i.width/2)+"px",opacity:"0"}),this.sticksData.push({$el:n,id:s})}},positionSticks:function(t,e){if(!this.sticksData||this.sticksData.length<1)return console.log("[view.positionSticks]: not enough sticks to position!"),!1;(_.isUndefined(t)||_.isNaN(t))&&(t=1);var s,a,n,o=0===i.data.game.totalAlignments||1===i.data.game.scrambleMoves;for(s=_.isNumber(e)?e:Math.floor(Math.random()*this.canvasData.movePositions.length),_.forEach(this.sticksData,_.bind(function(t){t.pos!==s&&(t.pos=t.newpos=s)},this));t--;)n=Math.ceil(Math.random()*this.sticksData.length),a=o?s>this.maxMoveSegments/2?"left":s<this.maxMoveSegments/2?"right":Math.random()<.5?"left":"right":Math.random()<.5?"left":"right",this.calculateStickPositions(!1,n,a,!0)},calculateStickPositions:function(t,e,s,a){var n=i.data.levels[i.data.levels.defaultLevel],o=1/n.moveDeterRatio;console.groupCollapsed("[view.calculateStickPositions]"),console.log("primaryStickIndex: ",e),console.log("swipeDirection: ",s),t||(t=this.sticksData),_.forEach(t,_.bind(function(t){t.deterLevel=Math.abs(t.id-e)+1;var i=this.maxMoveSegments/Math.pow(o,t.deterLevel);console.groupCollapsed("Stick: ",t.id),console.log("deterLevel: ",t.deterLevel),console.log("posShiftAmount: ",i),console.log("pos: ","["+t.pos+"]:",this.canvasData.colPosIndex[t.pos-1]),t.bounce=!1,t.cheat=!1,"left"==s?(t.newpos=t.pos-i,t.newpos<0&&(t.bounce="left",t.newpos=Math.abs(t.newpos))):"right"==s&&(t.newpos=t.pos+i,t.newpos>this.maxMoveSegments&&(t.bounce="right",t.newpos=2*this.maxMoveSegments-t.newpos)),t.pos=t.newpos,console.log("newpos: ","["+t.pos+"]:",this.canvasData.colPosIndex[t.pos-1]),console.log("bounce: ",t.bounce),console.log("cheat: ",t.cheat),console.groupEnd()},this)),console.groupEnd(),this.areAllSticksAligned=this.ifSticksAligned(),a&&this.areAllSticksAligned&&this.calculateStickPositions(!1,e,s,!0)},cheatStickPositions:function(t){var i="cheat",e=this.maxMoveSegments/2,s=_.isNumber(t)?t:e;console.groupCollapsed("[view.cheatStickPositions]"),console.log("primaryStickIndex: ",i),console.log("swipeDirection: ",i),_.forEach(this.sticksData,_.bind(function(t){t.cheat=!0,t.deterLevel=i,console.groupCollapsed("Stick: ",t.id),console.log("deterLevel: ",t.deterLevel),console.log("posShiftAmount: ",i),console.log("pos: ",t.pos),t.bounce=!1,t.newpos=s,t.pos=t.newpos,console.log("newpos: ",t.pos),console.log("bounce: ",t.bounce),console.log("cheat: ",t.cheat),console.groupEnd()},this)),console.groupEnd()},renderSticks:function(t,i,e){if(t||(t=this.sticksData),i&&i.length||(i=this.$sticksLayer),t.length<1)return console.log("[view.renderSticks]: not enough sticks to render!"),!1;for(this.gameInputDisabled=!0;i.find(".stick").length>t.length;){var s=i.find(".stick").length-1,a=i.find(".stick")[s];a.remove()}var n=i.find(".stick");_.forEach(t,_.bind(function(i){var s=8,a=this.canvasData.height/this.sticksData.length,o=(i.id-1)*a,c=i.newpos;(_.isUndefined(c)||_.isNaN(c))&&(c=Math.floor(Math.random()*this.canvasData.movePositions.length)),i.pos!=c&&(i.pos=c);var h=this.canvasData.movePositions[c],l=-1*s/2;0===c&&(l=0),c==this.canvasData.movePositions.length-1&&(l=-1*s);var r=e?0:(i.id-1)*(.6/t.length),d={width:s+"px",height:a+"px",top:o+"px",left:h+"px",marginLeft:l+"px",opacity:"1",delay:r};i.id==t.length&&_.merge(d,{onComplete:_.bind(function(){this.gameInputDisabled=!1,e&&this.updateAlignedSticks()},this)});var u={width:s+"px",height:a+"px",top:o+"px",left:"0px",marginLeft:"0px"},m={width:s+"px",height:a+"px",top:o+"px",left:this.canvasData.movePositions[this.maxMoveSegments]+"px",marginLeft:-1*s+"px"};!e||"left"!=i.bounce&&"right"!=i.bounce?TweenLite.to(i.$el[0],this.animSpeed.norm,d):TweenLite.to(i.$el[0],this.animSpeed.norm/2,_.merge("left"==i.bounce?u:m,{onComplete:_.bind(function(){TweenLite.to(i.$el[0],this.animSpeed.norm/2,d)},this)})),i.id>n.length&&i.$el.appendTo(this.$sticksLayer)},this))},resetSticks:function(){_.forEach(this.sticksData,_.bind(function(t){t.shrunk=!1},this)),this.updateDifficulty(),console.log("[view.resetSticks]"),this.positionSticks(i.data.game.scrambleMoves),this.renderSticks()},shrinkStick:function(t){if(t=_.isUndefined(t)?0:t,!this.sticksData[t].$el.length)return"[view.shrinkStick]: Invalid stick element!";var e=this.sticksData[t].$el[0],s=this.sticksData[0].cheat,a={width:"8px",height:"0px",top:"-45px",left:"50%",marginLeft:"-4px",onComplete:_.bind(function(){s||(i.data.game.stiiiiicks+=i.data.game.scrambleMoves,this.$game.trigger({type:"update.score",amount:i.data.game.scrambleMoves})),this.sticksData[t].shrunk=!0;var e={width:"8px",height:this.canvasData.height/this.sticksData.length+"px",top:this.canvasData.rowsPos[t]+"px",left:(t%2!==0?this.canvasData.width+50:-50)+"px",marginLeft:"0px",opacity:"0"};this.sticksData[t].$el.css(e),t==this.sticksData.length-1?(this.checkAlignBonus(),this.resetSticks()):this.shrinkStick(t+1)},this)};TweenLite.to(e,.6/this.sticksData.length,a)},updateGameStatus:function(){var t;return i.data.game.stiiiiicks<0?(t="lost",console.log("[updateGameStatus]: "+t),this.toggleDialogue({title:"Oops,<br>You have Lost!",actionLabel:"Try Again",actionMethod:_.bind(function(){this.restartLevel(),this.toggleDialogue()},this)})):(t="inProgress",console.log("[updateGameStatus]: "+t)),i.data.game.status=t,t},restartLevel:function(){var t=i.data.levels.currentLevel;this.initGame(i.data.levels[t]);var e=this.$settings.find('.btnLevel[data-level="'+t+'"]');e.length&&e.addClass("selected").siblings(".btnLevel").removeClass("selected"),console.log("[restartLevel]: "+t)},ifSticksAligned:function(){for(var t=1;t<this.sticksData.length;t++)if(this.sticksData[t].newpos!==this.sticksData[0].newpos)return!1;return!0},updateAlignedSticks:function(){this.areAllSticksAligned=this.ifSticksAligned(),this.areAllSticksAligned&&(this.gameInputDisabled=!0,i.data.game.totalAlignments++,this.shrinkStick())},checkAlignBonus:function(){var t=!1,e=this.sticksData.length;_.forEach(this.sticksData,_.bind(function(i){i.bounce&&(t=!0)},this)),t&&(i.data.game.stiiiiicks+=e,this.$game.trigger({type:"update.score",amount:e}),i.utils.popMsg({text:"Edge Bounce!<br><b>+"+e+"</b>"}),console.log("[checkAlignBonus]: bounceBonus",e))},updateDifficulty:function(){var t=i.data.game.scrambleMoves,e=null;1===i.data.game.totalAlignments?(i.data.game.scrambleMoves=1,i.utils.popMsg({text:"<b>Great</b><br>Start!"})):i.data.game.stiiiiicks<30&&i.data.game.scrambleMoves<=1?i.data.game.scrambleMoves=1:i.data.game.stiiiiicks<90&&i.data.game.scrambleMoves<=2?(i.data.game.scrambleMoves=2,e={text:"Too<br><b>Easy!</b>"}):i.data.game.stiiiiicks<180&&i.data.game.scrambleMoves<=3?(i.data.game.scrambleMoves=3,e={text:"Getting<br><b>Harder!</b>"}):i.data.game.stiiiiicks<390&&i.data.game.scrambleMoves<=4?(i.data.game.scrambleMoves=4,e={text:"Much More<br><b>Harder!</b>"}):i.data.game.scrambleMoves<=5&&(i.data.game.scrambleMoves=5,e={text:"You<br><b>Master!</b>"}),e&&i.data.game.scrambleMoves!==t&&i.utils.popMsg(e),console.log("[Total Moves]: ",i.data.game.totalMoves),console.log("[Total Cheats]: ",i.data.game.totalCheats),console.log("[Total Alignments]: ",i.data.game.totalAlignments),console.log("[StiiiiickS]: ",i.data.game.stiiiiicks),console.log("[view.updateDifficulty]: scrambleMoves",i.data.game.scrambleMoves)},updateGameCanvas:function(t,i){if(this.canvasData=this.getCanvasData(),this.maxMoveSegments=this.getMaxMoveSegments(t),this.initGrids(!1,!0),i&&this.sticksData.length){var e=this.canvasData.height/this.sticksData.length;_.forEach(this.sticksData,_.bind(function(t){var i=(t.id-1)*e,s=this.canvasData.movePositions[t.newpos];t.$el.css({height:e+"px",top:i+"px",left:s+"px"})},this))}},initGameEvents:function(t){$(window).off("resize.updateGameCanvas").on("resize.updateGameCanvas",_.bind(function(){this.updateGameCanvas(t,!0)},this)),this.$game.off("update.score").on("update.score",_.bind(function(){this.updateGameStatus(),this.updateScoreText()},this))},initGame:function(t){this.updateGameStatus(),i.data.levels.currentLevel=t.id,this.$game.removeClass(this.gui.levelClasses.join(" ")).addClass(this.gui.levelClasses[t.id]),this.gui.$scoreLabel.find(".count").text(new Array(t.sticksCount+1).join("i")),this.updateScoreText(t.initialStiiiiicks),this.addSticks(t.sticksCount),this.updateGameCanvas(t),this.positionSticks(),this.renderSticks(),this.initTouch(),this.initHammer(),this.initGameEvents(t)},toggleDialogue:function(t){var i=this.$dialogue.find(".title"),e=this.$dialogue.find(".btnAction");t?(i.html(t.title),e.text(t.actionLabel).off("click.button").on("click.button",t.actionMethod),this.$settings.hasClass("active")&&this.$settings.find(".btnSettings").trigger("click.button"),this.$game.addClass("fade"),this.$dialogue.addClass("active")):(i.text(""),e.empty().off("click.button"),this.$game.removeClass("fade"),this.$dialogue.removeClass("active"))},updateScoreText:function(t){var e=this.gui.$scoreText,s=parseInt(e.text(),10),a={transform:"translate(0, -2px) scale(1.5)",opacity:"1",ease:"easeIn",onComplete:_.bind(function(){TweenLite.to(e[0],this.animSpeed.scoreUp,{transform:"translate(0) scale(1)",opacity:"0.7",ease:"easeIn"})},this)},n={transform:"translate(0, -60px) scale(0.8)",opacity:"0",ease:"Power3.easeOut",onComplete:_.bind(function(){o.remove()},this)};if(_.isUndefined(t)||_.isNaN(t)||(i.data.game.stiiiiicks=Math.round(t)),i.data.game.stiiiiicks!==s)if(e.text(i.data.game.stiiiiicks),i.data.game.stiiiiicks>s)TweenLite.to(e[0],this.animSpeed.scoreUp,a);else{var o=e.clone().addClass("clone").text("-1").insertAfter(e);TweenLite.to(o[0],this.animSpeed.scoreDown,n)}},initGrids:function(t,i){for(var e=this.maxMoveSegments,s=this.sticksData.length,a=this.canvasData.colPosIndex="123456789abcdefghijklmnopqrstuvwxyz".split(""),n=this.canvasData.colsPos=[],o=this.canvasData.rowsPos=[],c=0;e>=c;c++)n.push(Math.round(this.canvasData.width/e*c));for(var h=0;s>=h;h++)o.push(Math.round(this.canvasData.height/s*h));this.$gridLayer.empty(),i&&_.forEach(n,_.bind(function(t){if(0!==t&&t!==this.canvasData.width){var i=$("<div/>");i.attr("data-index",a[n.indexOf(t)-1]).addClass("line vert").css({left:t+"px"}).appendTo(this.$gridLayer)}},this)),t&&_.forEach(o,_.bind(function(t){if(0!==t&&t!==this.canvasData.height){var i=$("<div/>");i.addClass("line horz").css({top:t+"px"}).appendTo(this.$gridLayer)}},this))},initSettings:function(){this.$settings.find('.btnLevel[data-level="'+i.data.levels.defaultLevel+'"]').addClass("selected").siblings(".btnLevel").removeClass("selected"),this.$gridLayer.hasClass("active")?this.$settings.find(".btnGrid").addClass("selected"):this.$settings.find(".btnGrid").removeClass("selected"),$(document).off("touchstart.button",'[data-role="button"]').on("touchstart.button",'[data-role="button"]',function(){$(this).addClass("active")}).off("touchend.button",'[data-role="button"]').on("touchend.button",'[data-role="button"]',function(){$(this).removeClass("active")}),$(".btnCheat").off("click.button").on("click.button",_.bind(function(t){t.preventDefault(),i.data.game.totalCheats++,i.data.game.stiiiiicks-=10,this.$game.trigger({type:"update.score",amount:-10}),this.cheatStickPositions(),this.renderSticks(!1,!1,!0)},this)),$(".btnSettings").off("click.button").on("click.button",_.bind(function(t){t.preventDefault(),this.$settings.toggleClass("active"),console.log("[View]: Toggle Settings: "+(this.$settings.hasClass("active")?"On":"Off"))},this)),$(".btnGrid").off("click.button").on("click.button",_.bind(function(t){t.preventDefault(),$(t.target).toggleClass("selected"),this.$gridLayer.toggleClass("active"),console.log("[View]: Toggle Grid: "+(this.$gridLayer.hasClass("active")?"On":"Off")),this.$settings.removeClass("active")},this)),$(".btnLevel").off("click.button").on("click.button",_.bind(function(t){t.preventDefault();var e=$(t.target),s=e.data().level;e.addClass("selected").siblings(".btnLevel").removeClass("selected"),this.initGame(i.data.levels[s]),console.log("[View]: Jump to Level: "+s),this.$settings.removeClass("active")},this))},initNoise:function(t,i){if(_.isUndefined(t)||!t.length)return"[View.initNoise]: Invalid target";var e={intensity:.6,size:200,opacity:.08,fallback:"",color:"#000000",randomColors:!1,monochrome:!1};i&&_.merge(e,i),t.noisy(e)},init:function(){i.utils.noTouchBounce(document.body),this.templates=i.utils.loadTemplates(),this.initNoise(this.$dialogue),this.initNoise(this.$settings),this.initNoise(this.$gameBg),this.initSettings(),this.initGame(i.data.levels[i.data.levels.defaultLevel])}},i}(window.App),window.App=function(t){return App=t||{},App.name="StiiiiickS",App.version="0.5.0",App.lastUpdate="2015-05",App.onDeviceReady=function(){console.log("[device] e:deviceready")},App.onPause=function(){console.log("[device] e:pause")},App.onResume=function(){console.log("[device] e:resume")},App.onOnline=function(){console.log("[device] e:online")},App.onOffline=function(){console.log("[device] e:offline"),App.utils.popMsg(App.data.msg.offline)},App.onBackbutton=function(){console.log("[device] e:backbutton"),window.history.back()},App.onMenubutton=function(){console.log("[device] e:menubutton")},App.init=function(){return window.Platform.iOS||window.Platform.android?(console.log("running on iOS/Android"),App.onDevice=!0,document.addEventListener("deviceready",this.onDeviceReady,!1),document.addEventListener("pause",this.onPause,!1),document.addEventListener("resume",this.onResume,!1),document.addEventListener("online",this.onOnline,!1),document.addEventListener("offline",this.onOffline,!1),document.addEventListener("backbutton",this.onBackbutton,!1),document.addEventListener("menubutton",this.onMenubutton,!1)):(console.log("NOT running on iOS/Android"),App.onDevice=!1,this.onDeviceReady()),$?(App.utils.init(),App.data.init(),void App.view.init()):!1},App}(window.App),App.init();