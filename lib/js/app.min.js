window.App=function(t){var n=t||{};return n.data={levels:{defaultLevel:0,0:{sticksCount:3,moveDeterRatio:.5}},msg:{connection_error:["Data Request Failed","Please make sure your device has a working connection and try again."],content_unavailable:["Content Unavailable","The content you requested is not available in this version of the app, please contact support."],offline:["No Connection Found","This app requires a working internet connection to work properly."]},init:function(){}},n}(window.App),window.App=function(t){var n=t||{};return window.Platform=function(){function t(t){return i.indexOf(t.toLowerCase())>-1}function n(t){return t in document.documentElement}var i=navigator.userAgent.toLowerCase();return this.iPhone=t("iPhone"),this.iPad=t("iPad"),this.iPod=t("iPod"),this.iOS=this.iPhone||this.iPad||this.iPod,this.android=t("android"),this.touchOS=n("ontouchstart"),this.chrome=i.indexOf("chrome")>-1,this.debugLog=function(){console.log("iPhone: "+this.iPhone),console.log("iPad: "+this.iPad),console.log("iPod: "+this.iPod),console.log("iOS: "+this.iOS),console.log("android: "+this.android),console.log("touchOS: "+this.touchOS)},this}(),window.Platform.iOS||window.Platform.android||(window.alert=function(t){console.log("window.alert: "+t)}),n.utils={addDeviceClass:function(){var t=Platform;$html=$("html:eq(0)"),$html.removeClass("no-js").addClass("js"),$html.addClass(t.touchOS?"touch":"no-touch"),t.iOS?($html.addClass("ios"),t.iPhone?$html.addClass("iphone"):t.iPod?$html.addClass("ipod"):t.iPad&&$html.addClass("ipad")):t.android&&$html.addClass("android")},checkConnection:function(){if(!navigator.connection)return!1;var t=navigator.connection.type;return t},popMsg:function(t){return!t||t.length<2?"Invalid title or message text":void(navigator.notification?navigator.notification.alert(t[1],function(){},t[0],t[2]?t[2]:"OK"):alert("["+t[0]+"]: "+t[1]))},reloadApp:function(){window.location=String(window.location).substr(0,String(window.location).indexOf("#"))},init:function(){this.addDeviceClass()}},n}(window.App),window.App=function(t){var n=t||{};return n.view={canvasData:null,sticksData:[],$document:$("document"),$sticksLayer:$("#sticksLayer"),touchEvents:["touchstart.sticksLayer","touchmove.sticksLayer","touchend.sticksLayer","touchleave.sticksLayer","touchcancel.sticksLayer"],onTouchStart:function(){},onTouchMove:function(){},onTouchEnd:function(){},initTouch:function(){this.$sticksLayer.off(this.touchEvents.join(" ")).on(this.touchEvents[0],this.onTouchStart).on(this.touchEvents[1],this.onTouchMove).on(this.touchEvents[2],this.onTouchEnd).on(this.touchEvents[3],this.onTouchEnd).on(this.touchEvents[4],this.onTouchEnd)},initHammer:function(t){this.hammer=new Hammer(this.$sticksLayer[0]),this.hammer.on("swipe",_.bind(function(n){var i=n.center.y,o=this.canvasData.height/this.sticksData.length,e=Math.ceil(i/o),s=1/t.moveDeterRatio;_.forEach(this.sticksData,_.bind(function(t){t.deterLevel=Math.abs(t.id-e);var i=this.maxMoveSegments/Math.pow(s,t.deterLevel);2==n.direction?(t.newpos=t.pos-i,t.newpos<0&&(t.newpos+=this.maxMoveSegments)):4==n.direction&&(t.newpos=t.pos+i,t.newpos>this.maxMoveSegments&&(t.newpos=t.newpos-this.maxMoveSegments))},this)),this.renderSticks()},this))},toggleLoader:function(t){var n=$("#loader"),i="active";return n.length?void(t?n.addClass(i):n.removeClass(i)):"no loader elem found"},getCanvasData:function(){var t={width:$(document).width(),height:$(document).height()};return t},getMaxMoveSegments:function(t){var n=Math.pow(1/t.moveDeterRatio,t.sticksCount-1);n=8,this.canvasData.movePositions=[];for(var i=0;n>=i;i++)this.canvasData.movePositions.push(i*this.canvasData.width/n);return n},addSticks:function(t){if(_.isNaN(t))return console.log("[view.addSticks]: invalid sticks count supplied!"),!1;for(;t--;){var n=this.sticksData.length+1,i=$("<div>");i.addClass("stick").attr("id","stick-"+n),this.sticksData.push({$el:i,id:n})}},renderSticks:function(){if(!this.sticksData||this.sticksData.length<1)return console.log("[view.renderSticks]: not enough sticks to render!"),!1;var t=this.$sticksLayer.find(".stick");_.forEach(this.sticksData,_.bind(function(n){var i=4,o=this.canvasData.height/this.sticksData.length,e=(n.id-1)*o,s=n.newpos;(!s||_.isNaN(s))&&(s=Math.floor(Math.random()*this.canvasData.movePositions.length)),n.pos=s;var a=this.canvasData.movePositions[s],c=-1*i/2;0==s&&(c=0),s==this.canvasData.movePositions.length-1&&(c=-1*i);var d={position:"absolute",width:i+"px",height:o+"px",top:e+"px",left:a+"px",marginLeft:c};n.$el.css(d),n.id>t.length&&n.$el.appendTo(this.$sticksLayer)},this))},initGame:function(t){this.canvasData=this.getCanvasData(),this.maxMoveSegments=this.getMaxMoveSegments(t),this.addSticks(t.sticksCount),this.renderSticks(t),this.initTouch(t),this.initHammer(t)},init:function(){this.initGame(n.data.levels[n.data.levels.defaultLevel])}},n}(window.App),window.App=function(t){return App=t||{},App.name="StiiiiickS",App.version="0.0.1",App.lastUpdate="2015-02",App.onDeviceReady=function(){console.log("[device] e:deviceready")},App.onPause=function(){console.log("[device] e:pause")},App.onResume=function(){console.log("[device] e:resume")},App.onOnline=function(){console.log("[device] e:online")},App.onOffline=function(){console.log("[device] e:offline"),App.utils.popMsg(App.data.msg.offline)},App.onBackbutton=function(){console.log("[device] e:backbutton"),window.history.back()},App.onMenubutton=function(){console.log("[device] e:menubutton")},App.init=function(){return window.Platform.iOS||window.Platform.android?(console.log("running on iOS/Android"),App.onDevice=!0,document.addEventListener("deviceready",this.onDeviceReady,!1),document.addEventListener("pause",this.onPause,!1),document.addEventListener("resume",this.onResume,!1),document.addEventListener("online",this.onOnline,!1),document.addEventListener("offline",this.onOffline,!1),document.addEventListener("backbutton",this.onBackbutton,!1),document.addEventListener("menubutton",this.onMenubutton,!1)):(console.log("NOT running on iOS/Android"),App.onDevice=!1,this.onDeviceReady()),$?(App.utils.init(),App.view.init(),void App.data.init()):!1},App}(window.App),App.init();